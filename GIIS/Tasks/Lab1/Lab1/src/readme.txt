4.1  Ѕыстрый способ доступа к пиксел€м в GDI и MFC

ѕри работе с функци€ми GDI напр€мую, наиболее удобным представл€етс€ создание объекта bitmap, к пиксел€м которого можно обращатьс€ напр€мую. ƒелаетс€ это с помощью функции CreateDIBSection. ќдним из выходных параметров этой функции €вл€етс€ указатель на переменную, куда при создании bitmap будет помещен указатель на массив пикселей - ppvBits. «апомнив этот указатель, приложение получает пр€мой доступ к пиксел€м изображени€. ќбычно использующиес€ true color изображени€ с глубиной цвета 24 bit хран€т данные попиксельно в виде массива троек `BGR' (каждый пиксель - три байта).

јдрес пиксел€ с координатами (x, y) дл€ изображений такого типа рассчитываетс€ следующим образом:
ppvBits + y * iBytesPerLine + x * 3
	(1)

«десь iBytesPerLine - это длина строки изображени€ в байтах, котора€ отнюдь не всегда равна ширине изображени€, умноженной на три. ƒл€ увеличени€ производительности работы с изображением адреса начал строк выравниваютс€ по границе процессорного слова (4 байта), поэтому если ширина, умноженна€ на 3, не кратна четырем, кажда€ из строк дополн€етс€ несколькими дополнительными байтами . –ассчитать длину строки в байтах можно по следующей формуле:
iBytesPerLine = (iWidth * 3 + 3) & -4;
	(2)